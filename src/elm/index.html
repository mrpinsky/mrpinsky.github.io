<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Participation Quiz</title>
    <!-- inject:css -->
    <!-- endinject -->
  </head>

  <body>
  </body>

  <!-- inject:js -->
  <!-- endinject -->

  <script type="text/javascript">
    var storedState = localStorage.getItem('elm-pq-save');
    var startingState = storedState ? JSON.parse(storedState) : null;
    var app = Elm.App.fullscreen(startingState);

    app.ports.focus.subscribe(function(selector) {
      setTimeout(function() {
        var nodes = document.querySelectorAll(selector);
        if (nodes.length === 1 && document.activeElement !== nodes[0]) {
          nodes[0].focus();
        }
      }, 50);
    });

    app.ports.setLocalStorage.subscribe(function(state) {
      console.log('USER: ', state.user);
      localStorage.setItem('elm-pq-save', JSON.stringify(state));
    });
  </script>
</html>
